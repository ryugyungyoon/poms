<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>회원가입</title>
	<link rel="stylesheet" href="/css/common.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<style>
	/* styles.css */
	body {
		font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
		margin: 0;
		padding: 0;
		display: flex;
		justify-content: center;
		align-items: center;
		background-color: #f3f4f6;
	}

	.container {
		width: 400px;
		background-color: #fff;
		padding: 20px;
		border-radius: 15px;
		box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
	}

	.container h2 {
		text-align: center;
		margin-bottom: 20px;
		color: #333;
	}

	.form-control {
		margin-bottom: 15px;
	}

	.form-control label {
		display: block;
		margin-bottom: 5px;
		color: #555;
	}

	.form-control input,
	.form-control select {
		width: calc(100% - 20px);
		padding: 10px;
		border-radius: 8px;
		border: 1px solid #ccc;
		outline: none;
		transition: border-color 0.3s ease;
	}

	.form-control input:focus,
	.form-control select:focus {
		border-color: #007bff;
	}

	ul {
		list-style: none;
		width: 100%;
	}

	ul li {
		display: inline-block;
		width: 45%;
	}

	.form-control button {
		width: 100%;
		padding: 10px;
		border: none;
		border-radius: 8px;
		background-color: #007bff;
		color: #fff;
		cursor: pointer;
		transition: background-color 0.3s ease;
	}

	.form-control button:hover {
		background-color: #0056b3;
	}

	@media screen and (max-width: 500px) {
		.container {
			width: 90%;
		}
	}

	.flex {
		display: flex;
	}

	.error_text{
		font-size: 13px;
		line-height: 18px;
		color : #ff3f3f;
	}
</style>
<script type="text/javascript">
	$(function (){
		//유효성 검사
		cfocus_valid('id', true, '아이디', /[a-zA-Z0-9\.\-\_]{5,15}/, '영문,숫자,특수문자(-_.)를 포함 5~15자리로 입력해 주세요.');
		cfocus_valid('pw', true, '비밀번호', /^(?=.*[a-zA-Z])(?=.*[!@#$%^+])(?=.*[0-9]).{5,15}$/, '영문, 숫자, 특수문자(!@#$%^+)를 각각 적어도 1개 이상 포함한 5~15자리로 입력해주세요.');
		cfocus_valid('name', true, '이름', null, null);
		cfocus_valid('birthday', false, '생년월일', /[0-9]{8}/, '8자리 숫자로 입력해 주세요.');
		cfocus_valid('contactNumber', true, '연락처', /[0-9]{12}/, '12자리 숫자로 입력해 주세요.');

		//회원가입 버튼
		$('#saveBtn').click(function(){
			if(!fn_valid('id', true)){
				return;
			};

			let userData = $('#signup-form').serialize();
			cfn_ajaxRequest('/save-user', 'POST', userData);
		});
	})

	/**
	 * [기능 함수] 일반 기능 ajax 요청 함수
	 * @author ryu
	 * @param url : 요청 url
	 * @param type : method (post, get)
	 * @param data : 전송 데이터
	 * @returns {void}
	 */
	function cfn_ajaxRequest(url, method, data, callbackId){
		var callback = url.split('/').reverse()[0];
		if(callbackId != undefined && callbackId != null) {
			callback = callbackId;
		}

		$.ajax({
			url: url,
			type: method,
			data: data,
			dataType: 'json',
			contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
			async: true,
			success: function(resData){
				fn_callback(callback, resData);
			}
		});
	}

	//validation
	function fn_valid(obj, isRequired){
		//필수 체크
		if(isRequired){
			//유효성 체크
			if ($('#' + obj).val()){
				//영문,숫자,특수문자(.-_) 5~15자리
				let regExp = /[a-zA-Z0-9\.\-\_]{5,15}/;
				let memberId = $('#id').val();
				if (!regExp.test(memberId)) {
					alert('아이디는 영문,숫자,특수문자(-_.)를 포함 5~15자리로 입력해 주세요.')
					$('#memberIdCValidYn').val('N');
					$('#memberId').focus();
					return false;
				}
				else{
					$('#memberIdCValidYn').val('Y');
					return true;
				}
			}
			else{
				return true;
			}
		}
	}

	//input focus validation
	function cfocus_valid(obj, isRequired, objText, regExp, isMsg){
		$('#'+obj).focusout(function(){
			$('#'+obj+'Msg').empty();

			//필수 체크
			if(isRequired){
				$('#'+obj+'Msg').show();
				$('#'+obj+'Msg').text(objText+'는(은) 필수 정보입니다.')
			}

			//유효성 체크
			if ($('#' + obj).val()){
				//영문,숫자,특수문자(.-_) 5~15자리
				if (!cfn_isEmpty(regExp)){
					if (!regExp.test($('#' + obj).val())){
						$('#' + obj + 'Msg').show();
						$('#' + obj + 'Msg').text(objText + '는(은) ' + isMsg);
					} else {
						$('#' + obj + 'Msg').hide();
					}
				}
				else{
					$('#' + obj + 'Msg').hide();
				}
			}
			else{}

		})
	}

	//요청 결과 처리 ajax callback
	function fn_callback(callbackId, resData){
		if(callbackId === 'save-user'){
			console.log(resData);
			alert('저장되었습니다.');
		}
		else{}
	}

	/**
	 * [일반 검증] 문자열의 null 확인
	 *
	 * @author ryu
	 * @param str 문자열
	 *
	 * @returns {Boolean}
	 */
	function cfn_isEmpty(str){
		if(str === null || str === undefined || str === '' || str === 'undefined' || str === 'null'){
			return true;
		}else{
			return false;
		}
	}
</script>
<body>
<div class="container">
	<form id="signup-form">
		<h2>회원가입</h2>
		<div class="form-control">
			<input type="text" name="id" id="id" placeholder="아이디" required>
		</div>
		<div class="error_text form-control" id="idMsg" style="display: none;"></div>
		<div class="form-control">
			<input type="password" name="pw" id="pw" placeholder="비밀번호">
		</div>
		<div class="error_text form-control" id="pwMsg" style="display: none;"></div>
		<div class="form-control">
			<input type="text" name="name" id="name" placeholder="이름">
		</div>
		<div class="error_text form-control" id="nameMsg" style="display: none;"></div>
		<div class="form-control">
			<input type="text" name="birthday" id="birthday" placeholder="생년월일">
		</div>
		<div class="error_text form-control" id="birthdayMsg" style="display: none;"></div>
		<div class="flex">
			<ul class="p-0">
				<li>
					<label for="gender1">남자</label>
					<input type="radio" name="gender" id="gender1" value="M">
				</li>
				<li>
					<label for="gender2">여자</label>
					<input type="radio" name="gender" id="gender2" value="F">
				</li>
			</ul>
		</div>
		<div class="form-control">
			<input type="text" name="contactNumber" id="contactNumber" placeholder="연락처">
			<input type="button" id="certifyBtn" value="인증요청">
		</div>
		<div class="error_text form-control" id="contactNumberMsg" style="display: none;"></div>
		<div class="form-control">
			<input type="email" name="email" id="email" placeholder="이메일">
		</div>
		<div class="form-control">
			<input type="text" class="w-100 mb-10 mr-10" name="postNumber" id="postNumber" placeholder="우편번호"><input type="button" class="w-80" value="우편 찾기"/>
			<input type="text" class="mb-10" name="address" id="address" placeholder="주소">
			<input type="text" name="addressDetail" id="addressDetail" placeholder="상세주소">
		</div>
		<div class="form-control">
			<input type="button" id="saveBtn" value="가입하기">
		</div>
	</form>
</div>
</body>
</html>